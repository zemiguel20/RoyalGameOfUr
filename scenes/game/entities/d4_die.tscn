[gd_scene load_steps=17 format=3 uid="uid://cvos81xjjq5nl"]

[ext_resource type="PhysicsMaterial" uid="uid://cewt4j3gn56bt" path="res://physics_materials/pm_die.tres" id="2_geqe1"]
[ext_resource type="Script" path="res://scripts/game/entities/die.gd" id="2_yl61n"]
[ext_resource type="Script" path="res://scripts/utils/precise_marker_3d.gd" id="3_7uyog"]
[ext_resource type="Script" path="res://scripts/game/entities/components/mesh_highlighter.gd" id="4_nhl43"]
[ext_resource type="Shader" path="res://shaders/wireframe.gdshader" id="7_kvqc4"]
[ext_resource type="Script" path="res://scripts/game/entities/components/selection_input_reader.gd" id="8_kxirt"]
[ext_resource type="Script" path="res://scripts/game/entities/components/die_tip.gd" id="8_ty4bl"]
[ext_resource type="Script" path="res://scripts/utils/self_destroy.gd" id="8_yg25q"]
[ext_resource type="Material" uid="uid://t1vd41m8k1hw" path="res://materials/mat_highlight_overlay_outline.tres" id="9_w20tm"]
[ext_resource type="Script" path="res://scripts/game/entities/components/simple_movement_animation_player.gd" id="10_bdh2j"]
[ext_resource type="PackedScene" uid="uid://bmkdsd8x5va6j" path="res://models/board_game/d4_die.glb" id="12_kusva"]
[ext_resource type="AudioStream" uid="uid://2yapgc7u1w10" path="res://audio/sfx_mastered/d4-on-table.mp3" id="12_uiiy4"]
[ext_resource type="Material" uid="uid://lc6rnvl5jhxi" path="res://materials/die/die_black.tres" id="13_bqubf"]

[sub_resource type="ConvexPolygonShape3D" id="ConvexPolygonShape3D_3llvo"]
points = PackedVector3Array(0, 1, 0, 0, -0.333, -0.943, 0.816, -0.333, 0.471, -0.816, -0.333, 0.471)

[sub_resource type="ShaderMaterial" id="ShaderMaterial_7wytk"]
render_priority = 0
shader = ExtResource("7_kvqc4")
shader_parameter/modelColor = null
shader_parameter/wireframeColor = Color(0.398491, 0.218447, 1, 1)
shader_parameter/width = 2.0
shader_parameter/modelOpacity = 0.0
shader_parameter/filtered = false

[sub_resource type="SphereShape3D" id="SphereShape3D_1v3fx"]

[node name="Die" type="RigidBody3D"]
input_ray_pickable = false
mass = 0.01
physics_material_override = ExtResource("2_geqe1")
gravity_scale = 0.078
contact_monitor = true
max_contacts_reported = 3
script = ExtResource("2_yl61n")
metadata/normals_root_node = NodePath("Tips")
metadata/highlight = NodePath("MeshHighlighter")
metadata/move_animation = NodePath("")
metadata/input_reader = NodePath("")
metadata/model = NodePath("Model/D4")
metadata/roll_sfx = NodePath("RollSFX")
metadata/timer = NodePath("RollForceStopTimer")

[node name="Model" parent="." instance=ExtResource("12_kusva")]
transform = Transform3D(0.85, 0, 0, 0, 0.85, 0, 0, 0, 0.85, 0, 0, 0)

[node name="D4" parent="Model" index="0"]
surface_material_override/0 = ExtResource("13_bqubf")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(0.022, 0, 0, 0, 0.022, 0, 0, 0, 0.022, 0, 0, 0)
shape = SubResource("ConvexPolygonShape3D_3llvo")

[node name="Tips" type="Node3D" parent="."]

[node name="Tip1" type="Node3D" parent="Tips"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.000181612, 0.0139439, -0.000104698)
script = ExtResource("8_ty4bl")
value = 1

[node name="Marker3D" type="Marker3D" parent="Tips/Tip1"]
gizmo_extents = 0.005
script = ExtResource("3_7uyog")
gizmo_extends_override = 0.005
metadata/value = 1

[node name="CSGPolygon3D" type="CSGPolygon3D" parent="Tips/Tip1"]
transform = Transform3D(0.00301859, 0, 0, 0, 0.00301859, 0, 0, 0, 0.00301859, 0, 0, 0)
polygon = PackedVector2Array(0, 0, 0, 2, 1, 0)
mode = 1
spin_degrees = 360.0
spin_sides = 8
material = SubResource("ShaderMaterial_7wytk")
script = ExtResource("8_yg25q")

[node name="Tip2" type="Node3D" parent="Tips"]
transform = Transform3D(1, 0, 0, 0, -0.305978, 0.952039, 0, -0.952039, -0.305978, -0.000164414, -0.00490745, -0.0129304)
script = ExtResource("8_ty4bl")

[node name="Marker3D" type="Marker3D" parent="Tips/Tip2"]
transform = Transform3D(1, 0, 0, 0, 1, 5.96046e-08, 0, -5.96046e-08, 1, 0, 0, 0)
gizmo_extents = 0.005
script = ExtResource("3_7uyog")
gizmo_extends_override = 0.005
metadata/value = 0

[node name="CSGPolygon3D" type="CSGPolygon3D" parent="Tips/Tip2"]
transform = Transform3D(0.00301859, 0, 0, 0, 0.00301859, 0, 0, 0, 0.00301859, 0, 0, 0)
polygon = PackedVector2Array(0, 0, 0, 2, 1, 0)
mode = 1
spin_degrees = 360.0
spin_sides = 8
material = SubResource("ShaderMaterial_7wytk")
script = ExtResource("8_yg25q")

[node name="Tip3" type="Node3D" parent="Tips"]
transform = Transform3D(-0.520309, 0.797508, 0.305384, 4.65661e-08, -0.357602, 0.933874, 0.853978, 0.485903, 0.186064, 0.010943, -0.00465297, 0.00629568)
script = ExtResource("8_ty4bl")
value = 1

[node name="Marker3D" type="Marker3D" parent="Tips/Tip3"]
transform = Transform3D(1, 6.85453e-07, 2.08616e-07, 0, 1, -4.39584e-07, -2.98023e-08, -7.45058e-08, 1, 0, 0, 0)
gizmo_extents = 0.005
script = ExtResource("3_7uyog")
gizmo_extends_override = 0.005
metadata/value = 1

[node name="CSGPolygon3D" type="CSGPolygon3D" parent="Tips/Tip3"]
transform = Transform3D(0.00301859, 0, 0, 0, 0.00301859, 0, 0, 0, 0.00301859, 0, 0, 0)
polygon = PackedVector2Array(0, 0, 0, 2, 1, 0)
mode = 1
spin_degrees = 360.0
spin_sides = 8
material = SubResource("ShaderMaterial_7wytk")
script = ExtResource("8_yg25q")

[node name="Tip4" type="Node3D" parent="Tips"]
transform = Transform3D(-0.521277, -0.812458, -0.261118, 4.62014e-08, -0.305978, 0.952039, -0.853387, 0.496276, 0.1595, -0.0112887, -0.00438574, 0.00652722)
script = ExtResource("8_ty4bl")

[node name="Marker3D" type="Marker3D" parent="Tips/Tip4"]
transform = Transform3D(1, -2.98023e-07, 4.61936e-07, -2.98023e-08, 0.999999, -3.12924e-07, -2.98023e-08, 2.98023e-08, 1, 0, 0, 0)
gizmo_extents = 0.005
script = ExtResource("3_7uyog")
gizmo_extends_override = 0.005
metadata/value = 0

[node name="CSGPolygon3D" type="CSGPolygon3D" parent="Tips/Tip4"]
transform = Transform3D(0.00301859, 0, 0, 0, 0.00301859, 0, 0, 0, 0.00301859, 0, 0, 0)
polygon = PackedVector2Array(0, 0, 0, 2, 1, 0)
mode = 1
spin_degrees = 360.0
spin_sides = 8
material = SubResource("ShaderMaterial_7wytk")
script = ExtResource("8_yg25q")

[node name="MeshHighlighter" type="Node" parent="." node_paths=PackedStringArray("target")]
script = ExtResource("4_nhl43")
material = ExtResource("9_w20tm")
target = NodePath("../Model/D4")

[node name="SimpleMovementAnimationPlayer" type="Node" parent="." node_paths=PackedStringArray("root_target")]
script = ExtResource("10_bdh2j")
root_target = NodePath("..")

[node name="SelectionInputReader" type="Area3D" parent="."]
script = ExtResource("8_kxirt")
_hold_threshold = 0.15

[node name="CollisionShape3D" type="CollisionShape3D" parent="SelectionInputReader"]
transform = Transform3D(0.07, 0, 0, 0, 0.07, 0, 0, 0, 0.07, 0, 0, 0)
shape = SubResource("SphereShape3D_1v3fx")

[node name="RollSFX" type="AudioStreamPlayer3D" parent="."]
stream = ExtResource("12_uiiy4")

[node name="RollForceStopTimer" type="Timer" parent="."]
wait_time = 3.5

[connection signal="body_entered" from="." to="." method="_on_collided_with_table"]

[editable path="Model"]
