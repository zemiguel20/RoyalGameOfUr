[gd_scene load_steps=16 format=3 uid="uid://ty6eqqsipbbi"]

[ext_resource type="PackedScene" uid="uid://cgkfm7n305bgj" path="res://scenes/game/environment_scaled.tscn" id="1_i3yx6"]
[ext_resource type="PackedScene" uid="uid://cbdwwx2xsmnky" path="res://scenes/boardgame.tscn" id="3_xprge"]
[ext_resource type="Script" path="res://scripts/ui/prototype_ui.gd" id="5_8sxhn"]
[ext_resource type="Script" path="res://scripts/ui/quit_button.gd" id="6_3dit1"]
[ext_resource type="PackedScene" uid="uid://bcjpac1cs0xcy" path="res://scenes/opponent_guard.tscn" id="7_tegfk"]
[ext_resource type="PackedScene" uid="uid://c8o1oiumwk2ow" path="res://scenes/game/looking_around/lookaround_camera.tscn" id="7_w116q"]
[ext_resource type="PackedScene" uid="uid://drllx28djyai7" path="res://scenes/npcs/npc_system.tscn" id="8_ayaro"]
[ext_resource type="PackedScene" uid="uid://b8730xnkhhion" path="res://scenes/ai_players/ai_player_hard.tscn" id="9_m0jtg"]

[sub_resource type="GDScript" id="GDScript_fbn4f"]
script/source = "extends Node

func _input(event):
	if event is InputEventKey and (event as InputEventKey).keycode == KEY_R:
		get_tree().reload_current_scene()


func _on_prototype_ui_fadeout_finished():
	get_tree().reload_current_scene()
"

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_k58kw"]

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_3ttc2"]

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_lt74h"]

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_6wjab"]

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_84i4a"]

[sub_resource type="Theme" id="Theme_q1r3c"]
Button/colors/font_color = Color(1, 0.686275, 0, 1)
Button/colors/font_hover_color = Color(1, 0.764706, 0, 1)
Button/colors/font_hover_pressed_color = Color(0.986026, 0.753848, 0, 1)
Button/colors/font_pressed_color = Color(0.984314, 0.752941, 0, 1)
Button/font_sizes/font_size = 100
Button/styles/disabled = SubResource("StyleBoxEmpty_k58kw")
Button/styles/focus = SubResource("StyleBoxEmpty_3ttc2")
Button/styles/hover = SubResource("StyleBoxEmpty_lt74h")
Button/styles/normal = SubResource("StyleBoxEmpty_6wjab")
Button/styles/pressed = SubResource("StyleBoxEmpty_84i4a")

[node name="Singleplayer" type="Node"]
script = SubResource("GDScript_fbn4f")

[node name="Environment" parent="." instance=ExtResource("1_i3yx6")]

[node name="Boardgame" parent="." instance=ExtResource("3_xprge")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="Board" parent="Boardgame" index="1"]
transform = Transform3D(0.019607, 0, -0.0313778, 0, 0.037, 0, 0.0313778, 0, 0.019607, 4.4739, -0.207527, 6.36155)

[node name="Dice" parent="Boardgame" index="2"]
transform = Transform3D(0.848049, 0, 0.529918, 0, 1, 0, -0.529918, 0, 0.848049, 4.44211, -0.213149, 6.346)

[node name="DiceArea_P1" parent="Boardgame/Dice" index="0"]
transform = Transform3D(0.026, 0, 3.72529e-09, 0, 0.026, 0, -3.72529e-09, 0, 0.026, 0, 0.1, 0.211021)

[node name="DiceBorders_P1" parent="Boardgame/Dice/DiceArea_P1" index="2"]
transform = Transform3D(1, 0, 1.19209e-07, 0, 1, 0, -1.19209e-07, 0, 1, 0, -2, 0)

[node name="Floor_Collider_P1" parent="Boardgame/Dice/DiceArea_P1" index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -3.988, 0)

[node name="CollisionShape3D" parent="Boardgame/Dice/DiceArea_P1/Floor_Collider_P1" index="0"]
transform = Transform3D(1, 0, -5.96046e-08, 0, 1, 0, 5.96046e-08, 0, 1, 0, 0, -0.46)

[node name="DiceArea_P2" parent="Boardgame/Dice" index="1"]
transform = Transform3D(0.026, 0, 3.72529e-09, 0, 0.026, 0, -3.72529e-09, 0, 0.026, -4.76837e-07, -0.0308831, -0.131)

[node name="ThrowingSpots_P2" parent="Boardgame/Dice/DiceArea_P2" index="0"]
transform = Transform3D(-5.96046e-08, 0, 1, 0, 1, 0, -1, 0, -5.96046e-08, -3.967, 5.653, 0.71)
visible = true

[node name="SpawnSpots_P2" parent="Boardgame/Dice/DiceArea_P2" index="1"]
transform = Transform3D(1, 0, 2.98023e-08, 0, 1, 0, -2.98023e-08, 0, 1, -0.253, 2.153, -0.617)

[node name="DiceBorders_P2" parent="Boardgame/Dice/DiceArea_P2" index="2"]
transform = Transform3D(1, 0, 2.98023e-08, 0, 1, 0, -2.98023e-08, 0, 1, 0, 3.153, 0)

[node name="Wall2" parent="Boardgame/Dice/DiceArea_P2/DiceBorders_P2" index="1"]
transform = Transform3D(1, 0, 2.98023e-08, 0, 1, 0, -2.98023e-08, 0, 1, 7.62939e-06, 2.979, -3.10864)

[node name="Wall3" parent="Boardgame/Dice/DiceArea_P2/DiceBorders_P2" index="2"]
transform = Transform3D(-2.98023e-08, 0, -1, 0, 1, 0, 1, 0, -2.98023e-08, -5.24678, 2.979, 0)

[node name="ClickHitbox_P2" parent="Boardgame/Dice/DiceArea_P2" index="3"]
transform = Transform3D(1.499, 0, 0, 0, 1.499, 0, 0, 0, 1.499, 0, 5.668, 0)

[node name="Floor_Collider_P2" parent="Boardgame/Dice/DiceArea_P2" index="5"]
transform = Transform3D(1, 0, -5.96046e-08, 0, 1, 0, 5.96046e-08, 0, 1, 0, 1.165, 0)

[node name="CollisionShape3D" parent="Boardgame/Dice/DiceArea_P2/Floor_Collider_P2" index="0"]
transform = Transform3D(1, 0, -5.96046e-08, 0, 1, 0, 5.96046e-08, 0, 1, 0, 0, -0.46)

[node name="AIMovePicker" parent="Boardgame" index="3"]
_best_move_weight = 15
_second_move_weight = 4
_random_move_weight = 1

[node name="MovePicker" parent="Boardgame" index="4"]
board_surface_y = -0.187

[node name="AIRoller" parent="Boardgame" node_paths=PackedStringArray("_dice", "_move_picker") instance=ExtResource("9_m0jtg")]
_dice = NodePath("../Dice")
_move_picker = NodePath("../MovePicker")

[node name="Custom_Camera" parent="." instance=ExtResource("7_w116q")]
transform = Transform3D(0.848048, 0, 0.529919, 0, 1, 0, -0.529919, 0, 0.848048, 4.67672, 0.189247, 6.67064)
max_degrees_down = 50.0
max_degrees_left = 45.0
max_degrees_right = 45.0
_board_look_rotation = Vector3(-40, 32, 0)
_trans_type = 1
_ease_type = 1

[node name="Prototype_UI" type="CanvasLayer" parent="."]
follow_viewport_enabled = true
script = ExtResource("5_8sxhn")

[node name="Fade_Panel" type="ColorRect" parent="Prototype_UI"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0)

[node name="Main Menu" type="Control" parent="Prototype_UI"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2

[node name="Play" type="Button" parent="Prototype_UI/Main Menu"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -205.0
offset_top = -75.0
offset_right = 197.0
offset_bottom = 89.0
grow_horizontal = 2
grow_vertical = 2
theme = SubResource("Theme_q1r3c")
text = "Play"

[node name="Quit" type="Button" parent="Prototype_UI/Main Menu"]
layout_mode = 1
anchors_preset = 3
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = -229.0
offset_top = -154.0
offset_right = -20.0
offset_bottom = -17.0
grow_horizontal = 0
grow_vertical = 0
theme = SubResource("Theme_q1r3c")
text = "Quit"
script = ExtResource("6_3dit1")

[node name="Opponent_Guard_Animated" parent="." instance=ExtResource("7_tegfk")]
transform = Transform3D(0.848048, 0, 0.52992, 0, 1, 0, -0.52992, 0, 0.848048, 4.17257, -0.684179, 5.80273)

[node name="NPCSystem" parent="." instance=ExtResource("8_ayaro")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.163454, 0.021807, -0.262183)

[node name="ToStorage_PathFollow3D" parent="NPCSystem/Paths/GuardPaths/ToStorage" index="0"]
transform = Transform3D(-0.34528, 0.0572691, -0.936741, -3.72526e-09, 0.998134, 0.0610216, 0.93849, 0.0210699, -0.344636, 0, 0, 0)

[node name="StorageToKitchen_PathFollow3D" parent="NPCSystem/Paths/GuardPaths/Storage_To_Kitchen" index="0"]
transform = Transform3D(0.0579449, 0, 0.998319, 0, 1, 0, -0.998319, 0, 0.0579449, -4.264, 0, 3.987)

[node name="KitchenToStart_PathFollow3D" parent="NPCSystem/Paths/GuardPaths/Kitchen_To_Start" index="0"]
transform = Transform3D(0.992532, 0, -0.12197, 0, 1, 0, 0.12197, 0, 0.992532, -0.203, 0, -0.637)

[node name="Kitchen_To_Storage_PathFollow3D" parent="NPCSystem/Paths/KitchenPaths/Kitchen_To_Storage" index="0"]
transform = Transform3D(0.999195, -0.000211939, 0.039862, -7.27588e-12, 0.999986, 0.00531663, -0.0398626, -0.00531246, 0.999181, -0.74496, -0.00807405, -0.924744)

[node name="StorageToKitchen2_PathFollow3D" parent="NPCSystem/Paths/KitchenPaths/Storage_To_Kitchen2" index="0"]
transform = Transform3D(-0.00153056, -0.000330129, 0.999994, -1.45518e-11, 1, 0.000330128, -0.999994, 5.05272e-07, -0.00153056, -4.51176, -0.000873566, 3.133)

[connection signal="game_ended" from="Boardgame/GameStateController" to="Prototype_UI" method="_on_game_ended"]
[connection signal="no_moves" from="Boardgame/GameStateController" to="Boardgame/Dice/DiceArea_P1/Label3D_Outcome_P1" method="_on_no_moves"]
[connection signal="roll_phase_started" from="Boardgame/GameStateController" to="Boardgame/AIRoller" method="_on_roll_phase_started"]
[connection signal="on_play_dialogue" from="Boardgame/AIMovePicker" to="Opponent_Guard_Animated" method="play_dialog"]
[connection signal="on_play_tutorial_dialogue" from="Boardgame/AIMovePicker" to="Opponent_Guard_Animated" method="play_tutorial_dialog"]
[connection signal="on_play_dialogue" from="Boardgame/MovePicker" to="Opponent_Guard_Animated" method="play_dialog"]
[connection signal="on_play_tutorial_dialogue" from="Boardgame/MovePicker" to="Opponent_Guard_Animated" method="play_tutorial_dialog"]
[connection signal="on_intro_ended" from="Custom_Camera" to="Boardgame/GameStateController" method="start_game"]
[connection signal="fadeout_finished" from="Prototype_UI" to="." method="_on_prototype_ui_fadeout_finished"]
[connection signal="play_pressed" from="Prototype_UI" to="Opponent_Guard_Animated" method="_on_play_pressed"]
[connection signal="pressed" from="Prototype_UI/Main Menu/Play" to="Prototype_UI" method="_on_play_pressed"]
[connection signal="pressed" from="Prototype_UI/Main Menu/Play" to="Prototype_UI" method="_on_game_started"]
[connection signal="pressed" from="Prototype_UI/Main Menu/Quit" to="Prototype_UI/Main Menu/Quit" method="_on_pressed"]
[connection signal="on_opponent_ready" from="Opponent_Guard_Animated" to="Custom_Camera" method="_on_play_pressed"]
[connection signal="on_prevent_opponent_action" from="Opponent_Guard_Animated/DialogueSystem/DialogueSequencePlayer" to="Boardgame/AIRoller" method="_disable_rolling"]
[connection signal="on_resume_opponent_action" from="Opponent_Guard_Animated/DialogueSystem/DialogueSequencePlayer" to="Boardgame/AIRoller" method="_enable_rolling"]

[editable path="Boardgame"]
[editable path="Boardgame/Board"]
[editable path="Boardgame/Dice"]
[editable path="Opponent_Guard_Animated"]
[editable path="NPCSystem"]
