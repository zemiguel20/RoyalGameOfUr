[gd_scene load_steps=14 format=3 uid="uid://cvs8yqeqllrsc"]

[ext_resource type="PackedScene" uid="uid://cgkfm7n305bgj" path="res://scenes/game/environment_scaled.tscn" id="1_ifuvb"]
[ext_resource type="PackedScene" uid="uid://cbdwwx2xsmnky" path="res://scenes/boardgame.tscn" id="2_fi2pv"]
[ext_resource type="PackedScene" uid="uid://b8730xnkhhion" path="res://scenes/ai_players/ai_player_hard.tscn" id="3_ml7vr"]
[ext_resource type="PackedScene" uid="uid://c8o1oiumwk2ow" path="res://scenes/game/looking_around/lookaround_camera.tscn" id="4_ikgtn"]
[ext_resource type="Script" path="res://scripts/npc_system/npc_data_manager.gd" id="5_5dtl3"]
[ext_resource type="PackedScene" uid="uid://4goheq1kyhy1" path="res://test/scenes/passenger_npc.tscn" id="6_d8mtd"]
[ext_resource type="PackedScene" uid="uid://c2osilgwlxj1y" path="res://test/scenes/kitchen_npc.tscn" id="7_ka0el"]

[sub_resource type="GDScript" id="GDScript_fbn4f"]
script/source = "extends Node

func _input(event):
	if event is InputEventKey and (event as InputEventKey).keycode == KEY_R:
		get_tree().reload_current_scene()


func _on_prototype_ui_fadeout_finished():
	get_tree().reload_current_scene()
"

[sub_resource type="Curve3D" id="Curve3D_c38qy"]
_data = {
"points": PackedVector3Array(1.17921, -0.0768166, 0.433843, -1.17921, 0.0768166, -0.433843, 0, 0, 0, 0, 0, 0, 0, 0, 0, -3.594, 0, -0.916, 0, 0, 0, 0, 0, 0, -12.414, 0, -1.165, 0, 0, 0, 0, 0, 0, -13.0017, 0, 0.385633),
"tilts": PackedFloat32Array(0, 0, 0, 0)
}
point_count = 4
up_vector_enabled = false

[sub_resource type="Curve3D" id="Curve3D_fbvn3"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, -4.264, 0, 3.987, -0.865, 0, 0, 0.865, 0, 0, -1.628, 0, 4.14, -0.0239821, 0, 0.897715, 0.0239821, 0, -0.897715, -0.254, 0, 2.214, 0, 0, 0, 0, 0, 0, -0.215, 0, -0.554),
"tilts": PackedFloat32Array(0, 0, 0, 0)
}
point_count = 4
up_vector_enabled = false

[sub_resource type="Curve3D" id="Curve3D_j1ftd"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, -0.203, 0, -0.637, 0, 0, 0, 0, 0, 0, -0.363, 0, 0.665, -2.02511, 0, -0.125696, 2.02511, 0, 0.125696, 1.74568, 0, 2.8336, 0, 0, 0, 0, 0, 0, 6.09242, 0, 4.81994, -0.633246, 0, 0.228384, 0.633246, 0, -0.228384, 7.14091, 0, 5.24557),
"tilts": PackedFloat32Array(0, 0, 0, 0, 0)
}
point_count = 5
up_vector_enabled = false

[sub_resource type="Curve3D" id="Curve3D_s5uld"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, -0.74496, -0.00807405, -0.924744, -0.024, 0, -0.898, 0.024, 0, 0.898, -0.639858, 0.00594401, 1.70974, 0.865, 0, 0, -0.865, 0, 0, -1.86563, 0, 3.12895, -0.865, 0, 0, 0, 0, 0, -5.11301, 0, 3.17073),
"tilts": PackedFloat32Array(0, 0, 0, 0)
}
point_count = 4
up_vector_enabled = false

[sub_resource type="Curve3D" id="Curve3D_snn0l"]
_data = {
"points": PackedVector3Array(0, 0, 0, 0, 0, 0, -5.11301, 0, 3.17073, -0.865, 0, 0, 0.865, 0, 0, -1.86563, 0, 3.12895, -0.0239821, 0, 0.897715, 0.0239821, 0, -0.897715, -0.703071, 0.0052011, 1.71327, 0, 0, 0, 0, 0, 0, -0.624147, -0.0158007, -0.897799),
"tilts": PackedFloat32Array(0, 0, 0, 0)
}
point_count = 4
up_vector_enabled = false

[node name="Singleplayer" type="Node"]
script = SubResource("GDScript_fbn4f")

[node name="Environment" parent="." instance=ExtResource("1_ifuvb")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.182807, 0, 0.264053)

[node name="Boardgame" parent="." instance=ExtResource("2_fi2pv")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="Board" parent="Boardgame" index="1"]
transform = Transform3D(0.019607, 0, -0.0313778, 0, 0.037, 0, 0.0313778, 0, 0.019607, 4.4739, -0.207527, 6.36155)

[node name="Dice" parent="Boardgame" index="2"]
transform = Transform3D(0.848049, 0, 0.529918, 0, 1, 0, -0.529918, 0, 0.848049, 4.44211, -0.213149, 6.346)

[node name="DiceArea_P1" parent="Boardgame/Dice" index="0"]
transform = Transform3D(0.026, 0, 3.72529e-09, 0, 0.026, 0, -3.72529e-09, 0, 0.026, 0, 0.1, 0.211021)

[node name="DiceBorders_P1" parent="Boardgame/Dice/DiceArea_P1" index="2"]
transform = Transform3D(1, 0, 1.19209e-07, 0, 1, 0, -1.19209e-07, 0, 1, 0, -2, 0)

[node name="Floor_Collider_P1" parent="Boardgame/Dice/DiceArea_P1" index="5"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -3.988, 0)

[node name="CollisionShape3D" parent="Boardgame/Dice/DiceArea_P1/Floor_Collider_P1" index="0"]
transform = Transform3D(1, 0, -5.96046e-08, 0, 1, 0, 5.96046e-08, 0, 1, 0, 0, -0.46)

[node name="DiceArea_P2" parent="Boardgame/Dice" index="1"]
transform = Transform3D(0.026, 0, 3.72529e-09, 0, 0.026, 0, -3.72529e-09, 0, 0.026, -4.76837e-07, -0.0308831, -0.131)

[node name="ThrowingSpots_P2" parent="Boardgame/Dice/DiceArea_P2" index="0"]
transform = Transform3D(-5.96046e-08, 0, 1, 0, 1, 0, -1, 0, -5.96046e-08, -3.967, 5.653, 0.71)
visible = true

[node name="SpawnSpots_P2" parent="Boardgame/Dice/DiceArea_P2" index="1"]
transform = Transform3D(1, 0, 2.98023e-08, 0, 1, 0, -2.98023e-08, 0, 1, -0.253, 2.153, -0.617)

[node name="DiceBorders_P2" parent="Boardgame/Dice/DiceArea_P2" index="2"]
transform = Transform3D(1, 0, 2.98023e-08, 0, 1, 0, -2.98023e-08, 0, 1, 0, 3.153, 0)

[node name="Wall2" parent="Boardgame/Dice/DiceArea_P2/DiceBorders_P2" index="1"]
transform = Transform3D(1, 0, 2.98023e-08, 0, 1, 0, -2.98023e-08, 0, 1, 7.62939e-06, 2.979, -3.10864)

[node name="Wall3" parent="Boardgame/Dice/DiceArea_P2/DiceBorders_P2" index="2"]
transform = Transform3D(-2.98023e-08, 0, -1, 0, 1, 0, 1, 0, -2.98023e-08, -5.24678, 2.979, 0)

[node name="ClickHitbox_P2" parent="Boardgame/Dice/DiceArea_P2" index="3"]
transform = Transform3D(1.499, 0, 0, 0, 1.499, 0, 0, 0, 1.499, 0, 5.668, 0)

[node name="Floor_Collider_P2" parent="Boardgame/Dice/DiceArea_P2" index="5"]
transform = Transform3D(1, 0, -5.96046e-08, 0, 1, 0, 5.96046e-08, 0, 1, 0, 1.165, 0)

[node name="CollisionShape3D" parent="Boardgame/Dice/DiceArea_P2/Floor_Collider_P2" index="0"]
transform = Transform3D(1, 0, -5.96046e-08, 0, 1, 0, 5.96046e-08, 0, 1, 0, 0, -0.46)

[node name="AIMovePicker" parent="Boardgame" index="3"]
_best_move_weight = 15
_second_move_weight = 4
_random_move_weight = 1

[node name="MovePicker" parent="Boardgame" index="4"]
board_surface_y = -0.187

[node name="AIRoller" parent="Boardgame" node_paths=PackedStringArray("_dice", "_move_picker") instance=ExtResource("3_ml7vr")]
_dice = NodePath("../Dice")
_move_picker = NodePath("../MovePicker")

[node name="Custom_Camera" parent="." instance=ExtResource("4_ikgtn")]
transform = Transform3D(0.848048, 0, 0.529919, 0, 1, 0, -0.529919, 0, 0.848048, 4.67672, 0.189247, 6.67064)
max_degrees_down = 50.0
max_degrees_left = 45.0
max_degrees_right = 45.0
_board_look_rotation = Vector3(-36, 32, 0)
_trans_type = 1
_ease_type = 1

[node name="NPCSystem" type="Node3D" parent="."]
script = ExtResource("5_5dtl3")

[node name="NPCs" type="Node3D" parent="NPCSystem"]

[node name="Passenger_NPC" parent="NPCSystem/NPCs" node_paths=PackedStringArray("_path", "_path2", "_path3") instance=ExtResource("6_d8mtd")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8.1165, 0.169593, 5.22195)
_path = NodePath("../../Paths/GuardPaths/ToStorage/ToStorage_PathFollow3D")
_path2 = NodePath("../../Paths/GuardPaths/Storage_To_Kitchen/StorageToKitchen_PathFollow3D")
_path3 = NodePath("../../Paths/GuardPaths/Kitchen_To_Start/KitchenToStart_PathFollow3D")
_rotation_speed = 0.8
_watch_game_probability = 0.3

[node name="Kitchen_NPC" parent="NPCSystem/NPCs" node_paths=PackedStringArray("_path", "_path2") instance=ExtResource("7_ka0el")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.681957, 0.158464, -2.3396)
_path = NodePath("../../Paths/KitchenPaths/Kitchen_To_Storage/Kitchen_To_Storage_PathFollow3D")
_path2 = NodePath("../../Paths/KitchenPaths/Storage_To_Kitchen2/StorageToKitchen2_PathFollow3D")

[node name="Paths" type="Node3D" parent="NPCSystem"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.662207, 0)

[node name="GuardPaths" type="Node3D" parent="NPCSystem/Paths"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8.1165, 0, 5.22195)

[node name="ToStorage" type="Path3D" parent="NPCSystem/Paths/GuardPaths"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.0613985, 0, 0)
curve = SubResource("Curve3D_c38qy")

[node name="ToStorage_PathFollow3D" type="PathFollow3D" parent="NPCSystem/Paths/GuardPaths/ToStorage"]
transform = Transform3D(-0.34528, 0.0572691, -0.936741, -3.72526e-09, 0.998135, 0.0610216, 0.93849, 0.0210699, -0.344636, 0, 0, 0)
use_model_front = true
loop = false

[node name="Storage_To_Kitchen" type="Path3D" parent="NPCSystem/Paths/GuardPaths"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.1165, 0, -5.22195)
curve = SubResource("Curve3D_fbvn3")

[node name="StorageToKitchen_PathFollow3D" type="PathFollow3D" parent="NPCSystem/Paths/GuardPaths/Storage_To_Kitchen"]
transform = Transform3D(0.0579448, 0, 0.998319, 0, 1, 0, -0.998319, 0, 0.0579448, -4.264, 0, 3.987)
use_model_front = true
loop = false

[node name="Kitchen_To_Start" type="Path3D" parent="NPCSystem/Paths/GuardPaths"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.1165, 0, -5.22195)
curve = SubResource("Curve3D_j1ftd")

[node name="KitchenToStart_PathFollow3D" type="PathFollow3D" parent="NPCSystem/Paths/GuardPaths/Kitchen_To_Start"]
transform = Transform3D(0.992532, 0, -0.12197, 0, 1, 0, 0.12197, 0, 0.992532, -0.203, 0, -0.637)
use_model_front = true
loop = false

[node name="KitchenPaths" type="Node3D" parent="NPCSystem/Paths"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 8.1165, 0, 5.22195)

[node name="Kitchen_To_Storage" type="Path3D" parent="NPCSystem/Paths/KitchenPaths"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.1165, 0, -5.22195)
visible = false
curve = SubResource("Curve3D_s5uld")

[node name="Kitchen_To_Storage_PathFollow3D" type="PathFollow3D" parent="NPCSystem/Paths/KitchenPaths/Kitchen_To_Storage"]
transform = Transform3D(0.999195, -0.000211939, 0.0398621, -1.45518e-11, 0.999986, 0.00531663, -0.0398626, -0.00531246, 0.999181, -0.74496, -0.00807405, -0.924744)
use_model_front = true
loop = false

[node name="Storage_To_Kitchen2" type="Path3D" parent="NPCSystem/Paths/KitchenPaths"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -8.1165, 0, -5.22195)
curve = SubResource("Curve3D_snn0l")

[node name="StorageToKitchen2_PathFollow3D" type="PathFollow3D" parent="NPCSystem/Paths/KitchenPaths/Storage_To_Kitchen2"]
transform = Transform3D(-0.0128659, 0, 0.999913, 0, 1, 0, -0.999913, 0, -0.0128659, -5.11301, 0, 3.17073)
use_model_front = true
loop = false

[connection signal="no_moves" from="Boardgame/GameStateController" to="Boardgame/Dice/DiceArea_P1/Label3D_Outcome_P1" method="_on_no_moves"]
[connection signal="roll_phase_started" from="Boardgame/GameStateController" to="Boardgame/AIRoller" method="_on_roll_phase_started"]
[connection signal="on_intro_ended" from="Custom_Camera" to="Boardgame/GameStateController" method="start_game"]

[editable path="Boardgame"]
[editable path="Boardgame/Board"]
[editable path="Boardgame/Dice"]
