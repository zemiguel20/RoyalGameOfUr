[gd_scene load_steps=9 format=3 uid="uid://dhkdop3qcru8a"]

[ext_resource type="PackedScene" uid="uid://cyj2hsx8jciw1" path="res://scenes/game/tile.tscn" id="1_qp715"]
[ext_resource type="PackedScene" uid="uid://cl2in1pyxem77" path="res://scenes/game/rosette_tile.tscn" id="2_qxn0r"]
[ext_resource type="PackedScene" uid="uid://dk03upbyn04nu" path="res://scenes/game/piece.tscn" id="3_6mfxs"]
[ext_resource type="PackedScene" uid="uid://cch6w4r6da147" path="res://scenes/game/black_piece.tscn" id="4_08e4r"]

[sub_resource type="GDScript" id="GDScript_x1y6j"]
script/source = "extends Node


@onready var tile = $Tile as Spot
@onready var r_tile = $RosetteTile as Spot
@onready var piece1 = $Piece as Piece
@onready var piece2 = $Piece2 as Piece
@onready var piece3 = $Piece3 as Piece


var started = false


func _ready() -> void:
	await get_tree().create_timer(1.0).timeout
	await tile.place_pieces([piece1], Piece.MOVE_ANIM.ARC)
	await tile.place_pieces([piece2], Piece.MOVE_ANIM.ARC)
	await r_tile.place_pieces([piece2], Piece.MOVE_ANIM.ARC)
	await r_tile.place_pieces([piece1], Piece.MOVE_ANIM.ARC)
	Settings.CAN_STACK_IN_SAFE_SPOT = true
	await r_tile.place_pieces([piece1], Piece.MOVE_ANIM.ARC)
	tile.remove_pieces()
	await r_tile.place_pieces([piece3], Piece.MOVE_ANIM.ARC)
	await tile.place_pieces(r_tile.remove_pieces(), Piece.MOVE_ANIM.ARC)
"

[sub_resource type="PlaneMesh" id="PlaneMesh_g3yvc"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_4c7a7"]
albedo_color = Color(0.45098, 0.0941176, 0.0235294, 1)

[sub_resource type="Environment" id="Environment_30q7u"]

[node name="SpotTest" type="Node"]
script = SubResource("GDScript_x1y6j")

[node name="Environment" type="Node" parent="."]

[node name="CSGMesh3D" type="CSGMesh3D" parent="Environment"]
transform = Transform3D(10, 0, 0, 0, 10, 0, 0, 0, 10, 0, -0.155926, 0)
mesh = SubResource("PlaneMesh_g3yvc")
material = SubResource("StandardMaterial3D_4c7a7")

[node name="Camera3D" type="Camera3D" parent="Environment"]
transform = Transform3D(0.999991, 0.00219803, -0.00376902, 0, 0.863835, 0.503775, 0.00436313, -0.50377, 0.863827, -0.210747, 3.87758, 6.1573)

[node name="WorldEnvironment" type="WorldEnvironment" parent="Environment"]
environment = SubResource("Environment_30q7u")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="Environment"]
transform = Transform3D(0.938752, 0.126596, 0.320497, -0.344594, 0.344877, 0.873107, 0, -0.930072, 0.367378, 0, 1.12308, 0)

[node name="Tile" parent="." instance=ExtResource("1_qp715")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.617235, 0.42758, 0.0269256)

[node name="RosetteTile" parent="." instance=ExtResource("2_qxn0r")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 1.92035, 0.10298, -0.00733423)
is_safe = true

[node name="Piece" parent="." instance=ExtResource("3_6mfxs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.8136, 0, 1.35089)

[node name="Piece2" parent="." instance=ExtResource("3_6mfxs")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4, 0, -1)

[node name="Piece3" parent="." instance=ExtResource("4_08e4r")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.38207, 0, 3.56059)
